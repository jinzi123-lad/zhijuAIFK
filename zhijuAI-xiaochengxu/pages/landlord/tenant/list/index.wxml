<view class="container pb-24">
  <view class="mesh-gradient"></view>
  <navbar title="æ™ºå±…AI-ç§Ÿå®¢ç®¡ç†" showBack="{{true}}"></navbar>

  <view class="main-body px-4 pt-4">
    <!-- Stats Cards -->
    <view class="stats-grid mb-4">
        <view class="stats-box glass-card centered">
            <text class="stats-val text-primary">{{stats.total}}</text>
            <text class="stats-lbl text-muted">æ€»ç§Ÿå®¢</text>
        </view>
        <view class="stats-box glass-card centered">
            <text class="stats-val text-success">{{stats.active}}</text>
            <text class="stats-lbl text-muted">åœ¨ç§Ÿ</text>
        </view>
        <view class="stats-box glass-card centered">
            <text class="stats-val text-warning">{{stats.expiring}}</text>
            <text class="stats-lbl text-muted">å³å°†åˆ°æœŸ</text>
        </view>
    </view>

    <!-- Search Bar -->
    <view class="search-bar glass-card mb-4 flex-row">
        <icon name="search" color="#94a3b8" size="36"></icon>
        <input class="search-input" placeholder="æœç´¢ç§Ÿå®¢å§“åã€ç”µè¯æˆ–æˆ¿æº" placeholder-class="ph-color" bindinput="onSearchInput" value="{{searchQuery}}"/>
    </view>

    <!-- Filter Tabs -->
    <scroll-view scroll-x="true" class="mb-4" show-scrollbar="false">
        <view class="filter-row">
            <view class="filter-pill {{filterStatus === 'all' ? 'active bg-primary text-white' : 'glass-card text-muted'}}" bindtap="setFilter" data-status="all">å…¨éƒ¨</view>
            <view class="filter-pill {{filterStatus === 'active' ? 'active bg-primary text-white' : 'glass-card text-muted'}}" bindtap="setFilter" data-status="active">åœ¨ç§Ÿ</view>
            <view class="filter-pill {{filterStatus === 'expiring' ? 'active bg-primary text-white' : 'glass-card text-muted'}}" bindtap="setFilter" data-status="expiring">å³å°†åˆ°æœŸ</view>
        </view>
    </scroll-view>

    <!-- Tenant List -->
    <view class="tenant-list">
        <block wx:for="{{filteredTenants}}" wx:key="id">
            <view class="tenant-card glass-card mb-3" bindtap="navToDetail" data-id="{{item.id}}">
                <view class="card-inner flex-row">
                    <!-- Avatar -->
                    <view class="avatar-circle bg-primary-20 centered">
                        <text class="avatar-text text-primary">{{item.name[0]}}</text>
                    </view>

                    <view class="info-content">
                        <view class="info-header mb-1 flex-row">
                            <text class="name-text">{{item.name}}</text>
                            <block wx:if="{{item.isExpiringSoon}}">
                                <view class="badge-warning">å³å°†åˆ°æœŸ</view>
                            </block>
                        </view>
                        
                        <view class="info-row text-muted mb-1">
                            <!-- Could replicate phone icon with <icon> but text is fine for compactness or use small icons -->
                            <text class="info-text">ğŸ“ {{item.phone}}</text>
                        </view>
                        <view class="info-row text-muted mb-2">
                             <text class="info-text">ğŸ“ {{item.property}}</text>
                        </view>

                        <view class="info-footer flex-row space-between">
                            <text class="rent-text text-primary">Â¥{{item.rent}}/æœˆ</text>
                            <text class="date-text text-muted">ğŸ“… åˆ°æœŸ: {{item.contractEndDate}}</text>
                        </view>
                    </view>

                    <view class="arrow-right">
                         <icon name="chevronRight" color="#94a3b8" size="40"></icon>
                    </view>
                </view>
            </view>
        </block>

        <block wx:if="{{filteredTenants.length === 0}}">
            <view class="empty-state centered">
                <text class="text-muted">æš‚æ— ç§Ÿå®¢ä¿¡æ¯</text>
            </view>
        </block>
    </view>
  </view>

  <!-- Floating Add Button -->
  <view class="fab-btn bg-primary icon-hover-bounce centered" bindtap="onAddTenant">
       <icon name="plus" color="#ffffff" size="56"></icon>
  </view>
</view>
