<view class="page-container">
  <navbar title="æˆ‘çš„åˆåŒ" />

  <!-- Tabåˆ‡æ¢ -->
  <view class="tabs">
    <view class="tab {{currentTab === 'active' ? 'active' : ''}}" bindtap="switchTab" data-tab="active">ç”Ÿæ•ˆä¸­</view>
    <view class="tab {{currentTab === 'pending' ? 'active' : ''}}" bindtap="switchTab" data-tab="pending">å¾…ç­¾çº¦</view>
    <view class="tab {{currentTab === 'expired' ? 'active' : ''}}" bindtap="switchTab" data-tab="expired">å·²ç»“æŸ</view>
  </view>

  <view wx:if="{{loading}}" class="loading">åŠ è½½ä¸­...</view>

  <view class="contract-list" wx:if="{{!loading}}">
    <view class="contract-card" wx:for="{{contracts}}" wx:key="id" 
      wx:if="{{(currentTab === 'active' && item.status === 'active') || (currentTab === 'pending' && (item.status === 'pending_tenant' || item.status === 'pending_landlord')) || (currentTab === 'expired' && (item.status === 'expired' || item.status === 'terminated'))}}">
      
      <view class="card-header">
        <text class="property-name">{{item.propertyTitle}}</text>
        <text class="status-tag status-{{item.status}}">{{item.statusText}}</text>
      </view>
      
      <view class="card-body" bindtap="goToDetail" data-id="{{item.id}}">
        <view class="info-row">
          <text class="label">æˆ¿ä¸œ</text>
          <text class="value">{{item.landlordName}}</text>
        </view>
        <view class="info-row">
          <text class="label">æœˆç§Ÿ</text>
          <text class="value price">Â¥{{item.rentAmount}}</text>
        </view>
        <view class="info-row">
          <text class="label">ç§ŸæœŸ</text>
          <text class="value">{{item.startDate}} ~ {{item.endDate}}</text>
        </view>
        <view class="info-row" wx:if="{{item.nextPayDate && item.status === 'active'}}">
          <text class="label">ä¸‹æ¬¡ç¼´è´¹</text>
          <text class="value highlight">{{item.nextPayDate}}</text>
        </view>
      </view>

      <!-- å¾…ç­¾çº¦æ“ä½œ -->
      <view class="card-footer" wx:if="{{item.status === 'pending_tenant'}}">
        <view class="btn btn-primary" catchtap="goToSign" data-id="{{item.id}}">æŸ¥çœ‹å¹¶ç­¾çº¦</view>
      </view>
    </view>

    <view wx:if="{{contracts.length === 0}}" class="empty">
      <text class="empty-icon">ğŸ“„</text>
      <text class="empty-text">æš‚æ— åˆåŒ</text>
    </view>
  </view>
</view>